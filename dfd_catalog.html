<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Simpli-FI | Denton Fire Resources</title>
    
    <!-- Tailwind & Icons -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- QR Code Generator Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        body { background-color: #F3F4F6; }
        .glass-panel { background: white; border: 1px solid #e5e7eb; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .resource-card { transition: all 0.2s; }
        .resource-card:active { transform: scale(0.98); }
        
        /* Smooth Fade for Modals */
        .modal-enter { animation: fadeIn 0.2s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body class="pb-24">

    <!-- HEADER -->
    <header class="bg-[#1e293b] text-white p-6 sticky top-0 z-40 shadow-lg">
        <div class="flex items-center justify-between mb-4">
            <div class="flex items-center gap-3">
                <!-- DENTON FIRE LOGO -->
                <div class="w-12 h-12 bg-white rounded-xl flex items-center justify-center p-1 shadow-md overflow-hidden">
                    <img src="https://files.constantcontact.com/3720c3fd901/10017eb4-f7d2-424d-92ed-c1b5424b9869.png" class="w-full h-full object-contain">
                </div>
                <div>
                    <h1 class="font-bold text-lg leading-tight">Resource Command</h1>
                    <p class="text-[10px] text-slate-400 uppercase tracking-wider font-bold">Denton Fire Department</p>
                </div>
            </div>
            <!-- Profile Avatar (Captain Lott) -->
            <div class="w-10 h-10 rounded-full bg-slate-600 border-2 border-[#fbbf24] overflow-hidden">
                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Hunter" class="w-full h-full object-cover">
            </div>
        </div>

        <!-- SEARCH BAR -->
        <div class="relative">
            <i data-lucide="search" class="absolute left-3 top-3.5 w-5 h-5 text-slate-400"></i>
            <input type="text" id="search-input" onkeyup="filterResources()" placeholder="Search protocols, forms, guides..." class="w-full pl-10 pr-4 py-3 bg-[#0f172a] border border-slate-700 rounded-xl text-sm text-white placeholder-slate-500 focus:outline-none focus:border-[#fbbf24] transition">
        </div>
    </header>

    <!-- CATEGORY TABS -->
    <div class="flex gap-2 p-4 overflow-x-auto no-scrollbar">
        <button onclick="filterCategory('all')" class="px-4 py-2 bg-[#1e293b] text-white text-xs font-bold rounded-full whitespace-nowrap shadow-sm">All Assets</button>
        <button onclick="filterCategory('public')" class="px-4 py-2 bg-white text-slate-600 text-xs font-bold rounded-full whitespace-nowrap border border-slate-200 shadow-sm">Public Info</button>
        <button onclick="filterCategory('internal')" class="px-4 py-2 bg-white text-slate-600 text-xs font-bold rounded-full whitespace-nowrap border border-slate-200 shadow-sm">Internal Ops</button>
        <button onclick="filterCategory('recruiting')" class="px-4 py-2 bg-white text-slate-600 text-xs font-bold rounded-full whitespace-nowrap border border-slate-200 shadow-sm">Recruiting</button>
    </div>

    <!-- RESOURCE GRID -->
    <main id="resource-grid" class="px-4 grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
        <!-- JS will inject cards here -->
    </main>

    <!-- FAB (Floating Action Button) -->
    <button onclick="openUploadModal()" class="fixed bottom-6 right-6 w-14 h-14 bg-[#fbbf24] text-[#1e293b] rounded-full shadow-2xl flex items-center justify-center hover:scale-110 transition z-50">
        <i data-lucide="plus" class="w-8 h-8"></i>
    </button>

    <!-- MODAL: QR DISPLAY -->
    <div id="qr-modal" class="fixed inset-0 z-[60] bg-slate-900/90 backdrop-blur-sm hidden items-center justify-center p-6">
        <div class="bg-white w-full max-w-sm rounded-3xl p-8 text-center relative modal-enter">
            <button onclick="closeModal('qr-modal')" class="absolute top-4 right-4 p-2 bg-slate-100 rounded-full hover:bg-slate-200 transition">
                <i data-lucide="x" class="w-4 h-4 text-slate-600"></i>
            </button>
            
            <div class="mb-6">
                <h3 id="qr-title" class="text-xl font-bold text-slate-800 mb-1">Resource Title</h3>
                <p class="text-xs text-slate-500 uppercase tracking-widest">Scan to Access</p>
            </div>

            <div class="bg-white p-4 rounded-2xl border-2 border-slate-100 shadow-inner inline-block mx-auto mb-6">
                <div id="qrcode"></div>
            </div>

            <div class="flex gap-2 justify-center text-[10px] text-slate-400 font-mono bg-slate-50 p-2 rounded-lg mb-6">
                <i data-lucide="activity" class="w-3 h-3 text-teal-500"></i>
                <span>Tracking Enabled: Location, Time, Device</span>
            </div>

            <button class="w-full py-3 bg-[#1e293b] text-white font-bold rounded-xl shadow-lg flex items-center justify-center gap-2">
                <i data-lucide="share" class="w-4 h-4"></i> Share Link Manually
            </button>
        </div>
    </div>

    <!-- MODAL: UPLOAD RESOURCE -->
    <div id="upload-modal" class="fixed inset-0 z-[60] bg-slate-900/90 backdrop-blur-sm hidden items-center justify-center p-6">
        <div class="bg-white w-full max-w-md rounded-3xl p-6 relative modal-enter">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-lg font-bold text-slate-800">Add New Resource</h2>
                <button onclick="closeModal('upload-modal')" class="p-2 bg-slate-100 rounded-full hover:bg-slate-200 transition">
                    <i data-lucide="x" class="w-4 h-4 text-slate-600"></i>
                </button>
            </div>

            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-1">Resource Title</label>
                    <input type="text" id="new-title" placeholder="e.g. Q4 Pricing Guide" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:border-[#fbbf24]">
                </div>
                
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-1">Destination URL</label>
                    <input type="url" id="new-url" placeholder="https://..." class="w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:border-[#fbbf24]">
                </div>

                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Category</label>
                    <div class="grid grid-cols-3 gap-2">
                        <button onclick="selectUploadCategory('public')" class="cat-btn py-2 bg-slate-100 rounded-lg text-xs font-bold text-slate-600 border border-transparent hover:border-[#fbbf24] focus:bg-[#1e293b] focus:text-white transition">Public</button>
                        <button onclick="selectUploadCategory('internal')" class="cat-btn py-2 bg-slate-100 rounded-lg text-xs font-bold text-slate-600 border border-transparent hover:border-[#fbbf24] focus:bg-[#1e293b] focus:text-white transition">Internal</button>
                        <button onclick="selectUploadCategory('recruiting')" class="cat-btn py-2 bg-slate-100 rounded-lg text-xs font-bold text-slate-600 border border-transparent hover:border-[#fbbf24] focus:bg-[#1e293b] focus:text-white transition">Recruiting</button>
                    </div>
                </div>

                <div class="pt-4">
                    <button onclick="saveResource()" class="w-full py-4 bg-[#fbbf24] text-[#1e293b] font-bold rounded-xl shadow-lg hover:shadow-xl transition flex items-center justify-center gap-2">
                        <i data-lucide="plus-circle" class="w-5 h-5"></i> Add to Catalog
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DATA STORE (Mock Data - Fire Department Specific) ---
        let resources = [
            {
                id: 1,
                title: "After the Fire Guide",
                category: "public",
                url: "https://www.cityofdenton.com/393/Fire-Rescue", // Updated to real Denton Fire Link
                icon: "flame",
                color: "text-orange-500",
                bg: "bg-orange-50"
            },
            {
                id: 2,
                title: "Recruiting Waitlist Form",
                category: "recruiting",
                url: "https://www.cityofdenton.com/jobs",
                icon: "users",
                color: "text-blue-500",
                bg: "bg-blue-50"
            },
            {
                id: 3,
                title: "Smoke Alarm Request",
                category: "public",
                url: "https://www.cityofdenton.com/FormCenter/Fire-Department-6/Smoke-Detector-Request-47",
                icon: "bell",
                color: "text-red-500",
                bg: "bg-red-50"
            },
            {
                id: 4,
                title: "Shift Calendar 2025",
                category: "internal",
                url: "https://internal.denton.gov/shifts",
                icon: "calendar",
                color: "text-slate-500",
                bg: "bg-slate-100"
            }
        ];

        // --- INIT ---
        window.onload = function() {
            renderResources(resources);
            lucide.createIcons();
        };

        // --- RENDER LOGIC ---
        function renderResources(data) {
            const grid = document.getElementById('resource-grid');
            grid.innerHTML = '';

            data.forEach(item => {
                const card = `
                    <div class="resource-card glass-panel rounded-2xl p-4 flex items-center justify-between cursor-pointer group hover:border-[#fbbf24]" onclick="openQR('${item.title}', '${item.url}')">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 rounded-xl ${item.bg} ${item.color} flex items-center justify-center shrink-0">
                                <i data-lucide="${item.icon}" class="w-6 h-6"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-slate-800 text-sm leading-tight group-hover:text-[#1e293b]">${item.title}</h3>
                                <span class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">${item.category}</span>
                            </div>
                        </div>
                        <div class="w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 group-hover:bg-[#fbbf24] group-hover:text-[#1e293b] transition">
                            <i data-lucide="qr-code" class="w-4 h-4"></i>
                        </div>
                    </div>
                `;
                grid.innerHTML += card;
            });
            lucide.createIcons();
        }

        // --- FILTER LOGIC ---
        function filterResources() {
            const query = document.getElementById('search-input').value.toLowerCase();
            const filtered = resources.filter(item => item.title.toLowerCase().includes(query));
            renderResources(filtered);
        }

        function filterCategory(cat) {
            if (cat === 'all') {
                renderResources(resources);
            } else {
                const filtered = resources.filter(item => item.category === cat);
                renderResources(filtered);
            }
        }

        // --- QR MODAL LOGIC ---
        function openQR(title, url) {
            document.getElementById('qr-title').innerText = title;
            document.getElementById('qrcode').innerHTML = ""; // Clear previous
            
            // In Production: This URL would be https://api.simpli-fi-os.com/track?redirect=${url}
            // For now, we generate the direct URL
            new QRCode(document.getElementById("qrcode"), {
                text: url,
                width: 150,
                height: 150,
                colorDark : "#1e293b",
                colorLight : "#ffffff",
                correctLevel : QRCode.CorrectLevel.H
            });

            const modal = document.getElementById('qr-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // --- UPLOAD LOGIC ---
        function openUploadModal() {
            const modal = document.getElementById('upload-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        let selectedCategory = 'public';
        function selectUploadCategory(cat) {
            selectedCategory = cat;
            // Visual feedback logic would go here (highlighting button)
        }

        function saveResource() {
            const title = document.getElementById('new-title').value;
            const url = document.getElementById('new-url').value;
            
            if(!title || !url) return alert("Please fill in all fields");

            // Add to local array (Simulation)
            resources.unshift({
                id: Date.now(),
                title: title,
                category: selectedCategory,
                url: url,
                icon: "link",
                color: "text-teal-500",
                bg: "bg-teal-50"
            });

            renderResources(resources);
            closeModal('upload-modal');
            
            // In Production: Firebase Write would happen here
        }

        function closeModal(id) {
            const modal = document.getElementById(id);
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }
    </script>
</body>
</html>
